<html>
	<head>
		<title>Write for Rights Events</title>
		<script type="text/javascript" src="js/ICanHaz.js"></script> 
		<script type="text/javascript" src='http://api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.js'></script>
		<script type="text/javascript" src='js/jquery.js '></script>
		<script type="text/javascript" src='js/tabletop.js'></script>
		<script type="text/javascript" src='js/sheetsee.js'></script>
		<script type="text/javascript" src='js/leaflet.markercluster.js'></script>
		<link rel="shortcut icon" href="https://raw.github.com/jlord/hack-spots/master/favico.png"http://www.amnesty.ca/>

		<meta name="viewport" content="width=device-width, initial-scale=1.0"http://www.amnesty.ca/>
		<link media="screen" rel="stylesheet" type="text/css" href="css/candle.css">
		<link href='http://api.tiles.mapbox.com/mapbox.js/v1.4.0/mapbox.css' rel='stylesheet' />	
		<link media="screen" rel="stylesheet" type="text/css" href="css/style.css"> 
		<link media="screen" rel="stylesheet" type="text/css" href="css/site.css"> 
		<link media="screen" rel="stylesheet" type="text/css" href="css/foundation.css"> 
		<link rel="stylesheet" href="css/MarkerCluster.css" />
		<link rel="stylesheet" href="css/MarkerCluster.Default.css" />
	</head>
<body>

<body class="not-front not-logged-in page-node activist-action sidebar-names-left_spades left-sidebar-names-spades sidebars-count-1 left-sidebars-count-1 right-sidebars-count-0 left-right-sidebars-count-1-0 primer path-node-52164 alias-write-for-rights-event-registration-events page-node-page_three_column">  
	<div class="region-page_subheader clear-block">      <div id="block-menu-menu-header-menu" class="block block-menu block-region-odd block-region-count-1 list-style-inline-separators block-floating-right block-margins-right font-size-10-a">
  
  
  <div class="content">
    <ul class="menu"><li class="leaf first last"><a href="http://www.amnesty.ca/contact" title="Contact Us">Contact Us</a></li>
</ul>  </div>

</div><!-- .block -->
  <div id="block-search-0" class="block block-search block-region-even block-region-count-2 block-floating-right clear-block">
  
  
  <div class="content">
    <form action="http://www.amnesty.ca/write-for-rights/event-registration/events"  accept-charset="UTF-8" method="post" id="search-block-form">
<div><div class="container-inline">
  <div class="form-item" id="edit-search-block-form-1-wrapper">
 <label for="edit-search-block-form-1">Search this site: </label>
 <input type="text" maxlength="128" name="search_block_form" id="edit-search-block-form-1" size="15" value="" title="Enter the terms you wish to search for." class="form-text" />
</div>
<input type="submit" name="op" id="edit-submit" value="Search"  class="form-submit" />
<input type="hidden" name="form_build_id" id="form-ceb144fb4169b8202b5f57b2cacf4550" value="form-ceb144fb4169b8202b5f57b2cacf4550"  />
<input type="hidden" name="form_id" id="edit-search-block-form" value="search_block_form"  />
</div>

</div></form>
  </div>

</div><!-- .block -->
  </div><!-- .region-page_subheader -->    <div class="page">	    <div class="region-page_header">      <div id="block-power_blocks-site_identifier" class="block block-power_blocks block-region-odd block-region-count-1 block-floating-left">
  
  
  <div class="content">
    <h1 class='site-identifier'><a href="http://www.amnesty.ca/" class="site-name active">Amnesty International Canada</a></h1>  </div>

</div><!-- .block -->
  <div id="block-menu_block-2" class="block block-menu_block block-region-even block-region-count-2 list-style-inline block-floating-right bebas-neue">
  
  
  <div class="content">
    <div class="menu-block-2 menu-name-secondary-links parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="leaf first menu-mlid-16268"><a href="http://www.amnesty.ca/write-for-rights" title="">writeathon</a></li>
<li class="leaf menu-mlid-1023 has-children"><a href="http://www.amnesty.ca/news" title="News">News</a></li>
<li class="leaf menu-mlid-1163 has-children"><a href="http://www.amnesty.ca/events" title="Events">Events</a></li>
<li class="leaf menu-mlid-4749 has-children"><a href="http://www.amnesty.ca/blog" title="Blog">Blog</a></li>
<li class="leaf menu-mlid-319 has-children"><a href="http://www.amnesty.ca/research" title="Research">Research</a></li>
<li class="leaf last menu-mlid-320"><a href="http://amnestyinternationalcanada.myshopify.com/" title="Store">Store</a></li>
</ul></div>
  </div>

</div><!-- .block -->
  <div id="block-menu_block-1" class="block block-menu_block block-region-odd block-region-count-3 list-style-inline block-floating-right block-clearing-right trade-gothic">
  
  
  <div class="content">
    <div class="menu-block-1 menu-name-primary-links parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="leaf first menu-mlid-312 has-children"><a href="http://www.amnesty.ca/our-work" title="Our Work">Our Work</a></li>
<li class="leaf menu-mlid-313 has-children"><a href="http://www.amnesty.ca/get-involved" title="Get Involved">Get Involved</a></li>
<li class="leaf menu-mlid-1182 has-children"><a href="http://www.amnesty.ca/donate" title="Donate">Donate</a></li>
<li class="leaf last menu-mlid-4466 has-children"><a href="http://www.amnesty.ca/about-us" title="About Us">About Us</a></li>
</ul></div>
  </div>

</div><!-- .block -->
  <div id="block-boxes-w4r_2013_banner" class="block block-boxes block-region-even block-region-count-4">
  
  
  <div class="content">
    <div id='boxes-box-w4r_2013_banner' class='boxes-box'><div class="boxes-box-content"><div class="w4r-subheader">
	<p><a href="http://www.amnesty.ca/write-for-rights"><img alt="" src="http://www.amnesty.ca/default/files/write-for-rights-banner-with-text_0.png" style="width: 940px; height: 267px;" /></a></p>
</div>
</div></div>  </div>

</div><!-- .block -->
  </div><!-- .region-page_header -->
  
  <div class="body clear-block">
        <div class="reports-banner"></div>         
      <div id="cont_wrap">  
               
        <div id="bc_bh">             
			<div class="breadcrumb"><a href="http://www.amnesty.ca/">Home</a> › <a href="http://www.amnesty.ca/write-for-rights" title="Write for Rights">Write for Rights</a> › <a href="http://www.amnesty.ca/write-for-rights/event-registration" title="Event Registration">Event Registration</a></div> 
                        <div class="clear-block"></div>
        <div class="clear"></div>
        </div>
        
                	<div class="region-sidebar_left_spades region-sidebar region-sidebar-left">      <div id="block-menu-menu-write-for-rights" class="block block-menu block-region-odd block-region-count-1">
  
      <div class="h-wrapper"><h3>Write for Rights</h3></div>
  
  <div class="content">
    <ul class="menu"><li class="expanded first last active-trail"><a href="http://www.amnesty.ca/write-for-rights" title="Write for Rights">Write for Rights</a><ul class="menu"><li class="collapsed first"><a href="http://www.amnesty.ca/write-for-rights/cases" title="Cases">Cases</a></li>
<li class="expanded active-trail"><a href="http://www.amnesty.ca/write-for-rights/event-registration" title="Event Registration">Event Registration</a><ul class="menu"><li class="expanded first last active-trail"><a href="http://www.amnesty.ca/write-for-rights/event-registration/events" title="Events" class="active">Events</a><ul class="menu"><li class="leaf first last"><a href="http://www.amnesty.ca/write-for-rights/events/live-reports" title="Live Reports">Live Reports</a></li>
</ul></li>
</ul></li>
<li class="leaf"><a href="http://www.amnesty.ca/write-for-rights/faq" title="FAQ">FAQ</a></li>
<li class="leaf"><a href="http://www.amnesty.ca/write-for-rights/resources" title="Resources">Resources</a></li>
<li class="leaf last"><a href="http://write4rights.tumblr.com/" title="">News</a></li>
</ul></li>
</ul>  </div>

</div><!-- .block -->
  </div><!-- .region-sidebar_left_spades -->        
        <div class="main">
          
		            <h1 class="title">Events</h1>
                     
           
          
          		              
	      <div class="buildmode-full">
  <div class="node node-type-page_three_column  clear-block">
    <div class="nd-region-header clear-block " ></div><div class="nd-region-middle-wrapper   nd-no-sidebars" ><div class="nd-region-middle"><div class="field field-title"><h1>Events</h1></div><div class="field field-body">

<!-- SHEETSEE -->

	<div id="wrapper">
		<div class="container">
			<div id="rightSide">
				<div id="latestSpot"></div>
				<div id="selectedSpot"></div>
			</div>
			<div id="map"></div>
		</div>
		<div class="container">
			<input id="tableFilter" type="text" placeholder="filter by.."></input>
			<span class="clear button">Clear</span> <span class="resetMap button">Reset Map</span>
			<span class="noMatches">no matches</span>
			<div id="hackSpotsTable"></div>
		</div>
		<!--<div id="info" class="container">
			<div id="thenumberofSpots"></div>
			<h3 class="subheader">Info</h3>
			<p></p>
		</div>-->
	</div><!-- end wrapper -->

<!-- Table Header -->
	<script id="hackSpotsTable" type="text/html">
		<table>
		<tr><th class="tHeader">Host</th><th class="tHeader">City</th><th class="tHeader">Province</th><th class="tHeader">Date</th><th class="">Map</th></tr>
		  {{#rows}}
		  	<tr id="{{rowNumber}}" class="spotRow">
		  	<td>{{host}}</td><td>{{city}}</td><td>{{province}}</td><td>{{start}}</td><td><a class="button" href="https://maps.google.com/maps?q={{address}}" target="_blank">G Map</a></td></tr>
		  {{/rows}}
	  </table>
	</script>

	<script id="latestSpot" type="text/html">
			{{#rows}}
				<h4 class="fauxButton">LATEST EVENT</h4>
				<h3 class="subheader">{{host}}</h3>
				<p class="colorText">{{eventtype}}<p>
				<p><em>{{address}}</em> {{room}}<p>
				<p>{{description}}</p>
				<ul>
			  	<li><span class="category">Host type:</span> {{hosttype}}</li>
			  	<li><span class="category">Start:</span> {{start}}</li>
			  	<li><span class="category">End:</span> {{end}}</li>
			  	<li><span class="category">Host website:</span> <a href="{{website}}">{{website}}</a></li>
			  	<li><span class="category">Event page:</span> <a href="{{webpage}}">{{webpage}}</a></li>
			</ul>
			<ul>
			  	<li><a href="https://maps.google.com/maps?q={{address}}" target="_blank">View in Google Maps</a></li>
		  	</ul>
		  {{/rows}}
	</script>

	<script id="thenumberofSpots" type="text/html">
		<p><strong><span class="red-text">{{numberofEvents}}</span> events strong!</p>
	</script>

	<script id="popUps" type="text/html">
		<h2>{{ name }}</h2>
	</script>

	<script id="selectedSpot" type="text/html">
		{{#rows}}
			<h4 class="fauxButton">SELECTED EVENT</h4>
				<h3 class="subheader">{{host}}</h3>
				<p class="colorText">{{eventtype}}<p>
				<p><em>{{address}}</em> {{room}}<p>
				<p>{{description}}</p>
				<ul>
			  	<li><span class="category">Host type:</span> {{hosttype}}</li>
			  	<li><span class="category">Start:</span> {{start}}</li>
			  	<li><span class="category">End:</span> {{end}}</li>
			  	<li><span class="category">Host website:</span> <a href="{{website}}">{{website}}</a></li>
			  	<li><span class="category">Event page:</span> <a href="{{webpage}}">{{webpage}}</a></li>
			</ul>
			<ul>
			  	<li><a href="https://maps.google.com/maps?q={{address}}" target="_blank">View in Google Maps</a></li>
		  	</ul>
	  {{/rows}}
	</script>

	<script type="text/javascript">
	  document.addEventListener('DOMContentLoaded', function() {
	  	var gData
	  	var URL = "0Am-bV1MBwPQHdFdLZGNlb2RBMTZvNWUyXzVtRmdvZVE"
			Tabletop.init( { key: URL, callback: showInfo, simpleSheet: true } ) 
		}) 

		// so long, so messy

          function showInfo(data) {
                  gData = data
                  // make the table, and the search bar
                  Sheetsee.makeTable(gData, "#hackSpotsTable")
                  Sheetsee.initiateTableFilter(gData, "#tableFilter", "#hackSpotsTable")

                  // when someone clicks on a row, highlight it and
                  // re-center the map
                  $('.spotRow').live("click", function(event) {
                          $('.spotRow').removeClass("selectedRow")
                                 var rowNumber = $(this).closest("tr").attr("id")
                                 $('#' + rowNumber).addClass("selectedRow")
                                 var dataElement = Sheetsee.getMatches(gData, rowNumber, "rowNumber")
                                 var selectedSpot = ich.selectedSpot({
                                  rows: dataElement
                          })
                          $('#latestSpot').css("display", "none")
                          $('#selectedSpot').html(selectedSpot).css("display", "inline")
                          var selectedCoords = [dataElement[0].lat, dataElement[0].long]
                          matchGeoJSONbyRowNumber(rowNumber, geoJSON, gData, "#FFFF00")
                          var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 13)
                                addPopups(map, markerLayer)
                          map.panTo(selectedCoords, 13)
                         })

                  // so that the first map and info that loads
                  // is complete and doesn't show rows that are
                  // actively being edited by folk
                  function findLatestCompleteSpot(data) {
                          var latestCompleteSpot = []
                          var startWithLatestRow = data.reverse()
                          startWithLatestRow.forEach(function(row){
                                  if (!row.lat || !row.long || !row.host  || !row.address || !row.publish ) return
                                  else latestCompleteSpot.push(row) 
                          })
                          return latestCompleteSpot[0]
                  }

                  // find the latest spot with the most important
                  // info filled in (to prevent map breaking if
                  // someone is currently editing spreadsheet)
                  var theLatestSpot = findLatestCompleteSpot(gData)
                  var latestSpot = ich.latestSpot({
                           rows: theLatestSpot
                  })
                        $('#latestSpot').html(latestSpot)

                        function highlightLastMarker(geoJSON, highlightColor) {
                                geoJSON[0].properties["marker-color"] = highlightColor
                                return geoJSON
                        }

                        // create geoJSON with coordinates and other
                        // useful bits from the original data
                        var optionsJSON = ["host", "address", "city", "rowNumber"]
                  var geoJSONnoHL = Sheetsee.createGeoJSON(gData, optionsJSON)
                  // change the color of the most recently added spot's marker
                  var geoJSON = highlightLastMarker(geoJSONnoHL, "#FFFF00")
                  // create map, tilelayer (map background), markers and popups
                        var map = Sheetsee.loadMap("map")
                        Sheetsee.addTileLayer(map, 'examples.map-20v6611k')
                        var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 13)
                        addPopups(map, markerLayer)

                        // design the popups to have the content and
                        // interactions that we want
                        function addPopups(map, markerLayer) {
                                markerLayer.eachLayer(function(marker) {
                                        var popupContent = ich.popUps(marker.feature.opts)
                                        marker.bindPopup(popupContent, {closeButton: false,})
                                })
                          markerLayer.on('click', function(e) {
                          // clear any selected rows        
                                $('.spotRow').removeClass("selectedRow")
                                // get row number of selected marker
                          var rowNumber = e.layer.feature.opts.rowNumber.toString()
                          // find that row in the table and make consider it selected
                          $('#' + rowNumber).addClass("selectedRow")
                          // using row number, find that marker in the geoJSON, give it
                          // the selected marker color
                          matchGeoJSONbyRowNumber(rowNumber, geoJSON, gData, "#FFFF00")
                         //  var markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 13)
                                // addPopups(map, markerLayer)
                                // using row number, get the data for the selected spot
                          var dataElement = Sheetsee.getMatches(gData, rowNumber, "rowNumber")
                          // take those details and re-write the selected spot section
                                var selectedSpot = ich.selectedSpot({
                                  rows: dataElement
                                 }) 
                          $('#latestSpot').css("display", "none")
                          $('#selectedSpot').html(selectedSpot).css("display", "inline")
                          })
                        }

                        $('.resetMap').click(function() {
                                $('.spotRow').removeClass("selectedRow")
                                markerLayer = Sheetsee.addMarkerLayer(geoJSON, map, 13)
                                addPopups(map, markerLayer)
                                $('#latestSpot').css("display", "inline")
                          $('#selectedSpot').css("display", "none")
                        })

                        // find total number of spots added
                        var numberOfSpots = gData.length
                        var theNumberofSpots = ich.theNumberofSpots({
                          numberOfSpots: numberOfSpots
                          })
                        $('#theNumberofSpots').html(theNumberofSpots)

                        function matchGeoJSONbyRowNumber(rowNumber, geoJSON, gdata, highlightColor) {
                                 geoJSON.forEach(function (d) {
                                         if (d.properties["marker-color"] === highlightColor) {
                                                 var origColor = gData[0].hexcolor
                                                 d.properties["marker-color"] = origColor
                                         }
                            for (var key in d.opts) {
                              var value = d.opts[key].toString().toLowerCase()
                                           if (key === 'rowNumber' && value.match(rowNumber.toString().toLowerCase())) {
                                 d.properties["marker-color"] = highlightColor
                                 return geoJSON
                                     }
                             }
                    })
                         }

         }

        </script>

        <!-- END SHEETSEE -->

</div></div></div>  </div> <!-- /node -->
</div> <!-- /buildmode -->         
          
        </div> <!-- .main -->
        
           
        	        
        <div class="clear"></div>
        
        </div> <!-- end cont_wrap -->

              </div> <!-- .body -->

      <div class="region-page_footer clear-block">      <div id="block-boxes-footer_slogan" class="block block-boxes block-region-odd block-region-count-1">
  
  
  <div class="content">
    <div id='boxes-box-footer_slogan' class='boxes-box'><div class="boxes-box-content">Amnesty International.
<em>Action</em> for Human Rights. <em>Hope</em> for Humanity.</div></div>  </div>

</div><!-- .block -->
  <div id="block-menu_block-4" class="block block-menu_block block-region-even block-region-count-2 list-style-inline-separators block-floating-right">
  
  
  <div class="content">
    <div class="menu-block-4 menu-name-menu-footer-secondary parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="leaf first menu-mlid-329"><a href="http://www.amnesty.ca/contact" title="Contact Us">Contact Us</a></li>
<li class="leaf menu-mlid-330"><a href="http://www.amnesty.ca/work-with-us" title="Work With Us">Work With Us</a></li>
<li class="leaf menu-mlid-331"><a href="http://www.amnesty.ca/rss" title="RSS">RSS</a></li>
<li class="leaf menu-mlid-333"><a href="https://www.facebook.com/amnestycanada" title="">Facebook</a></li>
<li class="leaf last menu-mlid-334"><a href="http://twitter.com/#!/AmnestyNow" title="">Twitter</a></li>
</ul></div>
  </div>

</div><!-- .block -->
  <div id="block-menu_block-3" class="block block-menu_block block-region-odd block-region-count-3 list-style-inline-separators block-floating-left">
  
  
  <div class="content">
    <div class="menu-block-3 menu-name-menu-footer-primary parent-mlid-0 menu-level-1">
  <ul class="menu"><li class="leaf first menu-mlid-328"><a href="http://www.amnesty.ca/" title="">Home</a></li>
<li class="leaf menu-mlid-323"><a href="http://www.amnesty.ca/sitemap" title="Site Map">Site Map</a></li>
<li class="leaf menu-mlid-324"><a href="http://www.amnesty.ca/help" title="Help">Help</a></li>
<li class="leaf menu-mlid-326"><a href="http://www.amnesty.ca/privacy-policy" title="Privacy Policy">Privacy Policy</a></li>
<li class="leaf menu-mlid-327"><a href="http://www.amnesty.ca/copyright" title="Terms &amp; Conditions">Copyright</a></li>
<li class="leaf menu-mlid-4572"><a href="http://www.amnesty.ca/accessibility" title="Accessibility: Our policy for providing services to people with disabilities">Accessibility</a></li>
<li class="leaf last menu-mlid-3001"><a href="http://www.amnistie.ca/" title="Français">Français</a></li>
</ul></div>
  </div>

</div><!-- .block -->
  </div><!-- .region-page_footer -->    </div> <!-- .page -->
    <div class="region-page_subfooter">      <div id="block-boxes-footer_message" class="block block-boxes block-region-odd block-region-count-1 list-style-inline-separators">
  
  
  <div class="content">
    <div id='boxes-box-footer_message' class='boxes-box'><div class="boxes-box-content"><ul>
	<li>
		&copy; 2013 Amnesty International Canada</li>
	<li>
		312 Laurier Ave E. Ottawa, ON. Canada K1N 1H9</li>
	<li>
		1-800-AMNESTY (1-800-266-3789)</li>
</ul></div></div>  </div>

</div><!-- .block -->
  </div><!-- .region-page_subfooter -->    
    <script type="text/javascript" src="http://www.amnesty.ca/default/files/js/js_d6985750208242fc9e3760c62f0c497a.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, { "basePath": "http://www.amnesty.ca/", "googleanalytics": { "trackOutbound": 1, "trackMailto": 1, "trackDownload": 1, "trackDownloadExtensions": "7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip" }, "colorbox": { "transition": "elastic", "speed": "350", "opacity": "0.90", "slideshow": false, "slideshowAuto": true, "slideshowSpeed": "2500", "slideshowStart": "start slideshow", "slideshowStop": "stop slideshow", "current": "{current} of {total} - hover over image to view caption", "previous": "« Prev", "next": "Next »", "close": "Close", "overlayClose": true, "maxWidth": "100%", "maxHeight": "100%" } });
//--><!]]>
</script>
        
    <script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-1288484-1"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = "http://www.amnesty.ca/default/files/googleanalytics/ga.js?s";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
   

</body>
</html>